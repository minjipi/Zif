<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸï¸ ZIF - í”„ë¦¬ë¯¸ì—„ Video to GIF ë³€í™˜ê¸°</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Bitcount:wght@400&display=swap"
        rel="stylesheet">
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f3f3f3 0%, #dce6f8 100%);
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .language-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #f6ab7a 0%, #e6956a 100%);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .language-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(246, 171, 122, 0.4);
        }

        .header h1 {
            margin: 0;
            font-size: 2.5rem;
            font-weight: 700;
            font-family: 'Bitcount', 'Inter', sans-serif;
            color: #2d3748;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header h3 {
            margin: 10px 0;
            font-weight: 600;
            font-family: 'Inter', sans-serif;
            color: #4a5568;
        }

        .tagline {
            color: #718096;
            font-size: 0.9rem;
            font-style: italic;
            margin: 10px 0;
        }

        .content {
            padding: 40px 30px;
        }

        .upload-section {
            background: #f3f3f3;
            border: 2px dashed #dce6f8;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .upload-section:hover {
            border-color: #f6ab7a;
            background: #faf9f8;
            transform: translateY(-2px);
        }

        .upload-section.dragover {
            border-color: #f6ab7a;
            background: #faf9f8;
            transform: scale(1.02);
        }

        .upload-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            color: #f6ab7a;
        }

        .upload-text {
            font-size: 1.2rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 10px;
        }

        .upload-subtext {
            color: #718096;
            font-size: 0.9rem;
        }

        #videoInput {
            display: none;
        }

        .settings-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
            margin-bottom: 30px;
        }

        .setting-group {
            background: linear-gradient(135deg, #f3f3f3 0%, #dce6f8 100%);
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #e2e8f0;
            position: relative;
            transition: all 0.3s ease;
        }

        .setting-group:hover {
            border-color: #f6ab7a;
            box-shadow: 0 8px 25px rgba(246, 171, 122, 0.15);
            transform: translateY(-2px);
            position: relative;
            z-index: 1;
        }

        .tooltip {
            position: absolute;
            bottom: -80px;
            left: 0;
            right: 0;
            margin: 0 auto;
            width: 320px;
            transform: translateY(-10px);
            background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 12px;
            font-size: 0.85rem;
            text-align: center;
            line-height: 1.5;
            z-index: 2000;
            pointer-events: none;
            opacity: 0;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .tooltip::after {
            content: '';
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-bottom: 10px solid #2d3748;
        }

        .tooltip.show {
            opacity: 1;
            transform: translateY(0);
        }

        .setting-group label {
            display: block;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 12px;
            font-size: 1rem;
        }

        .setting-group input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
            font-weight: 500;
        }

        .setting-group input:focus {
            outline: none;
            border-color: #f6ab7a;
            box-shadow: 0 0 0 4px rgba(246, 171, 122, 0.1);
            background: white;
        }

        .convert-btn {
            width: 100%;
            background: linear-gradient(135deg, #f6ab7a 0%, #e6956a 100%);
            color: white;
            border: none;
            padding: 20px 30px;
            border-radius: 15px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 30px;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            position: relative;
            overflow: hidden;
        }

        .convert-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .convert-btn:hover:not(:disabled)::before {
            left: 100%;
        }

        .convert-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(246, 171, 122, 0.4);
        }

        .convert-btn:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .preview-section,
        .output-section {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 800;
            color: #2d3748;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            padding-bottom: 10px;
            border-bottom: 3px solid #dce6f8;
        }

        #preview {
            display: flex;
            gap: 15px;
            overflow-x: auto;
            padding: 20px;
            background: linear-gradient(135deg, #f8f9ff 0%, #f0f2ff 100%);
            border-radius: 15px;
            border: 2px solid #e1e5f2;
        }

        #preview::-webkit-scrollbar {
            height: 10px;
        }

        #preview::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 5px;
        }

        #preview::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #f6ab7a, #e6956a);
            border-radius: 5px;
        }

        #preview img {
            max-height: 100px;
            border-radius: 10px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            border: 2px solid white;
        }

        #preview img:hover {
            transform: scale(1.1) rotate(2deg);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        .output-section {
            text-align: center;
        }

        #output img {
            max-width: 100%;
            border-radius: 15px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
            margin-bottom: 25px;
            border: 3px solid white;
        }

        #downloadLink {
            display: inline-block;
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
            text-decoration: none;
            padding: 18px 40px;
            border-radius: 50px;
            font-weight: 700;
            font-size: 1.2rem;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(72, 187, 120, 0.4);
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
        }

        #downloadLink::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s ease;
        }

        #downloadLink:hover::before {
            left: 100%;
        }

        #downloadLink:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(72, 187, 120, 0.5);
        }

        .advanced-settings {
            background: linear-gradient(135deg, #f3f3f3 0%, #dce6f8 100%);
            border-radius: 20px;
            padding: 0;
            margin-top: 30px;
            border: 2px solid #e2e8f0;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .advanced-settings-header {
            background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
            color: white;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            padding: 20px 25px;
            transition: all 0.3s ease;
        }

        .advanced-settings-header:hover {
            background: linear-gradient(135deg, #1a202c 0%, #171923 100%);
        }

        .advanced-settings-title {
            font-size: 1.3rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .toggle-icon {
            font-size: 1.5rem;
            transition: transform 0.4s ease;
            font-weight: bold;
        }

        .toggle-icon.rotated {
            transform: rotate(180deg);
        }

        .advanced-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease;
            padding: 0 25px;
        }

        .advanced-content.expanded {
            max-height: 800px;
            padding: 25px;
        }

        .quality-badge {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            color: #2d3748;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: 700;
            font-size: 0.9rem;
            margin-bottom: 20px;
            display: inline-block;
            box-shadow: 0 4px 12px rgba(255, 215, 0, 0.3);
        }

        canvas,
        video {
            display: none;
        }

        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            color: #2d3748;
            font-weight: 700;
            font-size: 1.1rem;
        }

        .spinner {
            width: 24px;
            height: 24px;
            border: 3px solid #e2e8f0;
            border-top: 3px solid #f6ab7a;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        @media (max-width: 768px) {
            .settings-grid {
                grid-template-columns: 1fr;
            }

            .tooltip {
                width: 280px;
                font-size: 0.8rem;
                bottom: -70px;
            }

            .header h1 {
                font-size: 2.5rem;
            }

            .content {
                padding: 25px 20px;
            }

            .language-toggle {
                position: static;
                margin-bottom: 20px;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1 id="title">ZIF</h1>
            <h3 id="subtitle">Premium Video to GIF Converter</h3>
            <p class="tagline" id="tagline">ìµœê³  í’ˆì§ˆì˜ GIF ë³€í™˜ì„ ìœ„í•œ ì•ˆì „í•˜ê³  í˜ì‹ ì ì¸ ì†”ë£¨ì…˜</p>
        </div>

        <div class="content">
            <div class="upload-section" id="uploadSection">
                <div class="upload-icon">ğŸ“</div>
                <div class="upload-text" id="uploadText">ë¹„ë””ì˜¤ íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”</div>
                <div class="upload-subtext" id="uploadSubtext">í´ë¦­í•˜ê±°ë‚˜ ë“œë˜ê·¸ & ë“œë¡­ìœ¼ë¡œ ì—…ë¡œë“œí•˜ë©´ ìë™ìœ¼ë¡œ GIFê°€ ìƒì„±ë©ë‹ˆë‹¤.</div>
                <input type="file" id="videoInput" accept="video/*">
            </div>

            <div class="preview-section" id="previewSection" style="display: none;">
                <div class="section-title">
                    <span>ğŸ“¸</span>
                    <span id="previewTitle">í”„ë ˆì„ ë¯¸ë¦¬ë³´ê¸°</span>
                </div>
                <div id="preview"></div>
            </div>

            <div class="output-section" id="outputSection" style="display: none;">
                <div class="section-title">
                    <span>âœ¨</span>
                    <span id="outputTitle">ìƒì„±ëœ GIF</span>
                </div>
                <div id="output"></div>
                <a id="downloadLink" style="display:none;" download="output.gif">
                    <span id="downloadText">GIF ë‹¤ìš´ë¡œë“œ</span>
                </a>

                <div class="advanced-settings" id="advancedSettings">
                    <div class="advanced-settings-header" id="advancedToggle">
                        <div class="advanced-settings-title">
                            <span>âš™ï¸</span>
                            <span id="advancedSettingsTitle">ê³ ê¸‰ ì„¤ì •</span>
                        </div>
                        <div class="toggle-icon" id="toggleIcon">â–¼</div>
                    </div>
                    <div class="advanced-content expanded" id="advancedContent">
                        <div class="settings-grid">
                            <div class="setting-group">
                                <label for="interval" id="intervalLabel">í”„ë ˆì„ ê°„ê²© (ì´ˆ)</label>
                                <input type="number" id="interval" value="1" step="0.1">
                            </div>

                            <div class="setting-group">
                                <label for="outputWidth" id="outputWidthLabel">ì¶œë ¥ ê°€ë¡œ í¬ê¸° (px)</label>
                                <input type="number" id="outputWidth" value="420" min="1">
                            </div>

                            <div class="setting-group">
                                <label for="quality" id="qualityLabel">í’ˆì§ˆ (1~100)</label>
                                <input type="number" id="quality" value="1" min="1" max="100">
                            </div>

                            <div class="setting-group">
                                <label for="fps" id="fpsLabel">FPS (í”„ë ˆì„/ì´ˆ)</label>
                                <input type="number" id="fps" value="10" min="1" max="60">
                            </div>
                        </div>

                        <button id="reconvertBtn" class="convert-btn">
                            <span id="reconvertText">ğŸ”„ ìƒˆ ì„¤ì •ìœ¼ë¡œ GIF ì¬ìƒì„±</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <video id="video" crossorigin="anonymous"></video>
    <canvas id="canvas"></canvas>
    <script src="/coi-serviceworker.js"></script>

    <script type="module">


        // ë‹¤êµ­ì–´ ì§€ì›
        let currentLanguage = localStorage.getItem('zifLanguage') || 'ko';

        const translations = {
            ko: {
                title: 'ZIF',
                subtitle: 'Premium Video to GIF Converter',
                tagline: 'ìµœê³  í’ˆì§ˆì˜ GIF ë³€í™˜ì„ ìœ„í•œ ì•ˆì „í•˜ê³  í˜ì‹ ì ì¸ ì†”ë£¨ì…˜',
                uploadText: 'ë¹„ë””ì˜¤ íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”',
                uploadSubtext: 'í´ë¦­í•˜ê±°ë‚˜ ë“œë˜ê·¸ & ë“œë¡­ìœ¼ë¡œ ì—…ë¡œë“œí•˜ë©´ ìë™ìœ¼ë¡œ GIFê°€ ìƒì„±ë©ë‹ˆë‹¤.',
                previewTitle: 'í”„ë ˆì„ ë¯¸ë¦¬ë³´ê¸°',
                outputTitle: 'ìƒì„±ëœ GIF',
                downloadText: 'GIF ë‹¤ìš´ë¡œë“œ',
                advancedSettingsTitle: 'ê³ ê¸‰ ì„¤ì •',
                intervalLabel: 'í”„ë ˆì„ ê°„ê²© (ì´ˆ)',
                outputWidthLabel: 'ì¶œë ¥ ê°€ë¡œ í¬ê¸° (px)',
                qualityLabel: 'í’ˆì§ˆ (1~100)',
                fpsLabel: 'FPS (í”„ë ˆì„/ì´ˆ)',
                reconvertText: 'ğŸ”„ ìƒˆ ì„¤ì •ìœ¼ë¡œ GIF ì¬ìƒì„±',
                loadingVideo: 'ë¹„ë””ì˜¤ë¥¼ ë¡œë”© ì¤‘...',
                extractingFrames: 'í”„ë ˆì„ì„ ì¶”ì¶œ ì¤‘...',
                generatingGif: 'GIF ìƒì„± ì¤‘...',
                completed: 'GIF ìƒì„± ì™„ë£Œ!',
                completedSubtext: 'ì•„ë˜ ê³ ê¸‰ ì„¤ì •ì—ì„œ ë‹¤ë¥¸ ì˜µì…˜ìœ¼ë¡œ ì¬ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤',
                regeneratingGif: 'GIF ì¬ìƒì„± ì¤‘...',
                langToggleText: 'í•œêµ­ì–´'
            },
            en: {
                title: 'ZIF',
                subtitle: 'Premium Video to GIF Converter',
                tagline: 'Safe and innovative solution for highest quality GIF conversion',
                uploadText: 'Select Video File',
                uploadSubtext: 'Click or drag & drop to upload and automatically generate GIF.',
                previewTitle: 'Frame Preview',
                outputTitle: 'Generated GIF',
                downloadText: 'ğŸ“¥ Download GIF',
                advancedSettingsTitle: 'Advanced Settings',
                intervalLabel: 'Frame Interval (seconds)',
                outputWidthLabel: 'Output Width (px)',
                qualityLabel: 'Quality (1~100)',
                fpsLabel: 'FPS (frames/second)',
                reconvertText: 'ğŸ”„ Regenerate GIF with New Settings',
                loadingVideo: 'Loading video...',
                extractingFrames: 'Extracting frames...',
                generatingGif: 'Generating GIF...',
                completed: 'GIF Generation Complete!',
                completedSubtext: 'You can regenerate with different options in advanced settings below',
                regeneratingGif: 'Regenerating GIF...',
                langToggleText: 'English'
            },
            ja: {
                title: 'ZIF',
                subtitle: 'ãƒ—ãƒ¬ãƒŸã‚¢ãƒ  Video to GIF ã‚³ãƒ³ãƒãƒ¼ã‚¿ãƒ¼',
                tagline: 'æœ€é«˜å“è³ªã®GIFå¤‰æ›ã®ãŸã‚ã®å®‰å…¨ã§é©æ–°çš„ãªã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³',
                uploadText: 'ãƒ“ãƒ‡ã‚ªãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„',
                uploadSubtext: 'ã‚¯ãƒªãƒƒã‚¯ã¾ãŸã¯ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã§ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã¨è‡ªå‹•çš„ã«GIFãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚',
                previewTitle: 'ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼',
                outputTitle: 'ç”Ÿæˆã•ã‚ŒãŸGIF',
                downloadText: 'ğŸ“¥ GIFãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰',
                advancedSettingsTitle: 'è©³ç´°è¨­å®š',
                intervalLabel: 'ãƒ•ãƒ¬ãƒ¼ãƒ é–“éš”ï¼ˆç§’ï¼‰',
                outputWidthLabel: 'å‡ºåŠ›å¹…ï¼ˆpxï¼‰',
                qualityLabel: 'å“è³ªï¼ˆ1~100ï¼‰',
                fpsLabel: 'FPSï¼ˆãƒ•ãƒ¬ãƒ¼ãƒ /ç§’ï¼‰',
                reconvertText: 'ğŸ”„ æ–°ã—ã„è¨­å®šã§GIFå†ç”Ÿæˆ',
                loadingVideo: 'ãƒ“ãƒ‡ã‚ªã‚’èª­ã¿è¾¼ã¿ä¸­...',
                extractingFrames: 'ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’æŠ½å‡ºä¸­...',
                generatingGif: 'GIFç”Ÿæˆä¸­...',
                completed: 'GIFç”Ÿæˆå®Œäº†ï¼',
                completedSubtext: 'ä¸‹ã®è©³ç´°è¨­å®šã§ä»–ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§å†ç”Ÿæˆã§ãã¾ã™',
                regeneratingGif: 'GIFå†ç”Ÿæˆä¸­...',
                langToggleText: 'æ—¥æœ¬èª'
            },
            zh: {
                title: 'ZIF',
                subtitle: 'é«˜çº§è§†é¢‘è½¬GIFè½¬æ¢å™¨',
                tagline: 'ç”¨äºæœ€é«˜è´¨é‡GIFè½¬æ¢çš„å®‰å…¨åˆ›æ–°è§£å†³æ–¹æ¡ˆ',
                uploadText: 'é€‰æ‹©è§†é¢‘æ–‡ä»¶',
                uploadSubtext: 'ç‚¹å‡»æˆ–æ‹–æ”¾ä¸Šä¼ ï¼Œè‡ªåŠ¨ç”ŸæˆGIFã€‚',
                previewTitle: 'å¸§é¢„è§ˆ',
                outputTitle: 'ç”Ÿæˆçš„GIF',
                downloadText: 'ğŸ“¥ ä¸‹è½½GIF',
                advancedSettingsTitle: 'é«˜çº§è®¾ç½®',
                intervalLabel: 'å¸§é—´éš”ï¼ˆç§’ï¼‰',
                outputWidthLabel: 'è¾“å‡ºå®½åº¦ï¼ˆpxï¼‰',
                qualityLabel: 'è´¨é‡ï¼ˆ1~100ï¼‰',
                fpsLabel: 'FPSï¼ˆå¸§/ç§’ï¼‰',
                reconvertText: 'ğŸ”„ ä½¿ç”¨æ–°è®¾ç½®é‡æ–°ç”ŸæˆGIF',
                loadingVideo: 'æ­£åœ¨åŠ è½½è§†é¢‘...',
                extractingFrames: 'æ­£åœ¨æå–å¸§...',
                generatingGif: 'æ­£åœ¨ç”ŸæˆGIF...',
                completed: 'GIFç”Ÿæˆå®Œæˆï¼',
                completedSubtext: 'æ‚¨å¯ä»¥åœ¨ä¸‹é¢çš„é«˜çº§è®¾ç½®ä¸­ä½¿ç”¨ä¸åŒé€‰é¡¹é‡æ–°ç”Ÿæˆ',
                regeneratingGif: 'æ­£åœ¨é‡æ–°ç”ŸæˆGIF...',
                langToggleText: 'ä¸­æ–‡'
            }
        };


        // íˆ´íŒ ê¸°ëŠ¥
        const tooltips = {
            ko: {
                'interval': 'ë¹„ë””ì˜¤ì—ì„œ í”„ë ˆì„ì„ ì¶”ì¶œí•˜ëŠ” ì‹œê°„ ê°„ê²©ì…ë‹ˆë‹¤. ê°’ì´ ì‘ì„ìˆ˜ë¡ ë” ë¶€ë“œëŸ¬ìš´ GIFê°€ ìƒì„±ë˜ì§€ë§Œ íŒŒì¼ í¬ê¸°ê°€ ì»¤ì§‘ë‹ˆë‹¤.',
                'outputWidth': 'GIFì˜ ê°€ë¡œ í”½ì…€ í¬ê¸°ì…ë‹ˆë‹¤. ê°’ì´ í´ìˆ˜ë¡ í™”ì§ˆì´ ì¢‹ì•„ì§€ì§€ë§Œ íŒŒì¼ í¬ê¸°ê°€ ì»¤ì§‘ë‹ˆë‹¤.',
                'quality': 'GIFì˜ ì••ì¶• í’ˆì§ˆì…ë‹ˆë‹¤. 1ì´ ìµœê³  í’ˆì§ˆ(ìµœëŒ€ íŒŒì¼ í¬ê¸°), 100ì´ ìµœì € í’ˆì§ˆ(ìµœì†Œ íŒŒì¼ í¬ê¸°)ì…ë‹ˆë‹¤.',
                'fps': 'ì´ˆë‹¹ í‘œì‹œë˜ëŠ” í”„ë ˆì„ ìˆ˜ì…ë‹ˆë‹¤. ê°’ì´ í´ìˆ˜ë¡ ë¹ ë¥´ê²Œ ì¬ìƒë˜ê³ , ì‘ì„ìˆ˜ë¡ ëŠë¦¬ê²Œ ì¬ìƒë©ë‹ˆë‹¤.'
            },
            en: {
                'interval': 'Time interval for extracting frames from video. Smaller values create smoother GIFs but larger file sizes.',
                'outputWidth': 'Horizontal pixel size of the GIF. Larger values improve quality but increase file size.',
                'quality': 'GIF compression quality. 1 is highest quality (largest file size), 100 is lowest quality (smallest file size).',
                'fps': 'Frames displayed per second. Higher values play faster, lower values play slower.'
            },
            ja: {
                'interval': 'ãƒ“ãƒ‡ã‚ªã‹ã‚‰ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’æŠ½å‡ºã™ã‚‹æ™‚é–“é–“éš”ã§ã™ã€‚å€¤ãŒå°ã•ã„ã»ã©ã‚¹ãƒ ãƒ¼ã‚ºãªGIFãŒç”Ÿæˆã•ã‚Œã¾ã™ãŒã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒå¤§ãããªã‚Šã¾ã™ã€‚',
                'outputWidth': 'GIFã®æ¨ªãƒ”ã‚¯ã‚»ãƒ«ã‚µã‚¤ã‚ºã§ã™ã€‚å€¤ãŒå¤§ãã„ã»ã©ç”»è³ªãŒè‰¯ããªã‚Šã¾ã™ãŒã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒå¤§ãããªã‚Šã¾ã™ã€‚',
                'quality': 'GIFã®åœ§ç¸®å“è³ªã§ã™ã€‚1ãŒæœ€é«˜å“è³ªï¼ˆæœ€å¤§ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºï¼‰ã€100ãŒæœ€ä½å“è³ªï¼ˆæœ€å°ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºï¼‰ã§ã™ã€‚',
                'fps': '1ç§’é–“ã«è¡¨ç¤ºã•ã‚Œã‚‹ãƒ•ãƒ¬ãƒ¼ãƒ æ•°ã§ã™ã€‚å€¤ãŒå¤§ãã„ã»ã©é«˜é€Ÿå†ç”Ÿã•ã‚Œã€å°ã•ã„ã»ã©ä½é€Ÿå†ç”Ÿã•ã‚Œã¾ã™ã€‚'
            },
            zh: {
                'interval': 'ä»è§†é¢‘ä¸­æå–å¸§çš„æ—¶é—´é—´éš”ã€‚å€¼è¶Šå°ç”Ÿæˆçš„GIFè¶Šæµç•…ï¼Œä½†æ–‡ä»¶å¤§å°è¶Šå¤§ã€‚',
                'outputWidth': 'GIFçš„æ°´å¹³åƒç´ å¤§å°ã€‚å€¼è¶Šå¤§ç”»è´¨è¶Šå¥½ï¼Œä½†æ–‡ä»¶å¤§å°è¶Šå¤§ã€‚',
                'quality': 'GIFå‹ç¼©è´¨é‡ã€‚1ä¸ºæœ€é«˜è´¨é‡ï¼ˆæœ€å¤§æ–‡ä»¶å¤§å°ï¼‰ï¼Œ100ä¸ºæœ€ä½è´¨é‡ï¼ˆæœ€å°æ–‡ä»¶å¤§å°ï¼‰ã€‚',
                'fps': 'æ¯ç§’æ˜¾ç¤ºçš„å¸§æ•°ã€‚å€¼è¶Šå¤§æ’­æ”¾è¶Šå¿«ï¼Œè¶Šå°æ’­æ”¾è¶Šæ…¢ã€‚'
            }
        }

        function setupTooltips() {
            const settingGroups = document.querySelectorAll('.setting-group');

            settingGroups.forEach((group, index) => {
                const input = group.querySelector('input');
                const inputId = input.id;

                if (tooltips[currentLanguage] && tooltips[currentLanguage][inputId]) {
                    // ê¸°ì¡´ íˆ´íŒ ì œê±°
                    const existingTooltip = group.querySelector('.tooltip');
                    if (existingTooltip) {
                        existingTooltip.remove();
                    }

                    const tooltip = document.createElement('div');
                    tooltip.className = 'tooltip';
                    tooltip.textContent = tooltips[currentLanguage][inputId];
                    group.appendChild(tooltip);

                    group.addEventListener('mouseenter', () => {
                        tooltip.classList.add('show');
                    });

                    group.addEventListener('mouseleave', () => {
                        tooltip.classList.remove('show');
                    });
                }
            });
        }

        function updateAllTexts() {
            const t = translations[currentLanguage];

            document.getElementById('title').textContent = t.title;
            document.getElementById('subtitle').textContent = t.subtitle;
            document.getElementById('tagline').textContent = t.tagline;
            document.getElementById('uploadText').textContent = t.uploadText;
            document.getElementById('uploadSubtext').textContent = t.uploadSubtext;
            document.getElementById('previewTitle').textContent = t.previewTitle;
            document.getElementById('outputTitle').textContent = t.outputTitle;
            document.getElementById('downloadText').textContent = t.downloadText;
            document.getElementById('advancedSettingsTitle').textContent = t.advancedSettingsTitle;
            document.getElementById('intervalLabel').textContent = t.intervalLabel;
            document.getElementById('outputWidthLabel').textContent = t.outputWidthLabel;
            document.getElementById('qualityLabel').textContent = t.qualityLabel;
            document.getElementById('fpsLabel').textContent = t.fpsLabel;
            document.getElementById('reconvertText').textContent = t.reconvertText;

            // íˆ´íŒ ì—…ë°ì´íŠ¸
            setupTooltips();
        }

        if (!localStorage.getItem('zifLanguage')) {
            const browserLang = navigator.language.slice(0, 2); // 'en-US' â†’ 'en'
            const supportedLangs = ['ko', 'en', 'ja', 'zh'];
            currentLanguage = supportedLangs.includes(browserLang) ? browserLang : 'en';
            localStorage.setItem('zifLanguage', currentLanguage);
        }
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì–¸ì–´ ì„¤ì • ì ìš©
        updateAllTexts();



        // ì „ì—­ ë³€ìˆ˜ë“¤
        let defaultInterval = 1;
        let defaultwWidth = 420;
        let defaultQuality = 70;
        let defaultFps = 1;

        let frames = [];
        let outputWidth = 420;
        let outputHeight = 0;
        let currentVideoFile = null;

        // DOM ìš”ì†Œë“¤
        const videoInput = document.getElementById('videoInput');
        const reconvertBtn = document.getElementById('reconvertBtn');
        const video = document.getElementById('video');
        const canvas = document.getElementById('canvas');
        const preview = document.getElementById('preview');
        const output = document.getElementById('output');
        const downloadLink = document.getElementById('downloadLink');
        const intervalInput = document.getElementById('interval');
        const qualityInput = document.getElementById('quality');
        const fpsInput = document.getElementById('fps');
        const outputWidthInput = document.getElementById('outputWidth');
        const uploadSection = document.getElementById('uploadSection');
        const outputSection = document.getElementById('outputSection');
        const previewSection = document.getElementById('previewSection');
        const advancedToggle = document.getElementById('advancedToggle');
        const advancedContent = document.getElementById('advancedContent');
        const toggleIcon = document.getElementById('toggleIcon');

        // ê³ ê¸‰ ì„¤ì • í† ê¸€
        advancedToggle.addEventListener('click', () => {
            advancedContent.classList.toggle('expanded');
            toggleIcon.classList.toggle('rotated');
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ íˆ´íŒ ì„¤ì •
        setupTooltips();


        // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ê¸°ëŠ¥
        uploadSection.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadSection.classList.add('dragover');
        });

        uploadSection.addEventListener('dragleave', (e) => {
            e.preventDefault();
            uploadSection.classList.remove('dragover');
        });

        uploadSection.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadSection.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0 && files[0].type.startsWith('video/')) {
                handleVideoFile(files[0]);
            }
        });

        uploadSection.addEventListener('click', () => {
            videoInput.click();
        });

        // ê¸°ì¡´ ê¸°ëŠ¥ ìœ ì§€
        videoInput.addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if (!file) return;
            handleVideoFile(file);
        });

        async function handleVideoFile(file) {
            currentVideoFile = file;

            // ë¡œë”© í‘œì‹œ
            uploadSection.innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                    <span>ë¹„ë””ì˜¤ë¥¼ ë¡œë”© ì¤‘...</span>
                </div>
            `;

            video.src = URL.createObjectURL(file);
            await video.play();
            video.pause();

            // ê¸°ë³¸ ì„¤ì •ê°’ ì ìš©
            outputWidth = defaultwWidth;
            const aspectRatio = video.videoHeight / video.videoWidth;
            outputHeight = Math.round(outputWidth * aspectRatio);

            // í”„ë ˆì„ ì¶”ì¶œ í‘œì‹œ
            uploadSection.innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                    <span>í”„ë ˆì„ì„ ì¶”ì¶œ ì¤‘...</span>
                </div>
            `;

            // ê¸°ë³¸ê°’ìœ¼ë¡œ í”„ë ˆì„ ì¶”ì¶œ
            frames = await extractFrames(video, defaultInterval);

            // ë¯¸ë¦¬ë³´ê¸° ì„¹ì…˜ í‘œì‹œ
            previewSection.style.display = 'block';

            // GIF ìë™ ìƒì„± ì‹œì‘
            uploadSection.innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                    <span>GIF ìƒì„± ì¤‘...</span>
                </div>
            `;

            // ìë™ìœ¼ë¡œ GIF ìƒì„±
            await generateGIF(frames, defaultwWidth, defaultQuality, defaultFps);

            // ì™„ë£Œ í‘œì‹œ
            uploadSection.innerHTML = `
                <div class="upload-icon">âœ…</div>
                <div class="upload-text">GIF ìƒì„± ì™„ë£Œ!</div>
                <div class="upload-subtext">ì•„ë˜ ê³ ê¸‰ ì„¤ì •ì—ì„œ ë‹¤ë¥¸ ì˜µì…˜ìœ¼ë¡œ ì¬ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</div>
            `;

            // ì¶œë ¥ ì„¹ì…˜ í‘œì‹œ
            outputSection.style.display = 'block';
        }

        // ì¬ë³€í™˜ ë²„íŠ¼ ì´ë²¤íŠ¸
        reconvertBtn.addEventListener('click', async () => {
            if (!currentVideoFile) return;

            const originalText = reconvertBtn.textContent;
            reconvertBtn.innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                    <span>GIF ì¬ìƒì„± ì¤‘...</span>
                </div>
            `;
            reconvertBtn.disabled = true;

            // ìƒˆë¡œìš´ ì„¤ì •ê°’ ì ìš©
            const newInterval = parseFloat(intervalInput.value) || 1;
            const newWidth = parseInt(outputWidthInput.value, 10) || 420;
            const newQuality = parseInt(qualityInput.value, 10) || 1;
            const newFps = parseInt(fpsInput.value, 10) || 10;

            // í¬ê¸°ê°€ ë³€ê²½ë˜ì—ˆìœ¼ë©´ í”„ë ˆì„ ì¬ì¶”ì¶œ
            if (newWidth !== defaultwWidth || newInterval !== defaultInterval) {
                defaultwWidth = newWidth;
                defaultInterval = newInterval;
                outputWidth = newWidth;
                const aspectRatio = video.videoHeight / video.videoWidth;
                outputHeight = Math.round(outputWidth * aspectRatio);

                frames = await extractFrames(video, newInterval);
            }

            await generateGIF(frames, newWidth, newQuality, newFps);

            reconvertBtn.textContent = originalText;
            reconvertBtn.disabled = false;
        });

        async function generateGIF(frameList, width, quality, fps) {
            const ctx = canvas.getContext('2d');
            const imageDatas = [];

            canvas.width = width;
            canvas.height = outputHeight;

            for (const blob of frameList) {
                const img = await blobToImage(blob);
                ctx.drawImage(img, 0, 0, width, canvas.height);
                const data = ctx.getImageData(0, 0, width, canvas.height);
                imageDatas.push(data);
            }

            const worker = new Worker(new URL('./assets/gif.worker.js', import.meta.url), { type: 'module' });

            worker.postMessage({
                frames: imageDatas,
                width: width,
                height: canvas.height,
                quality,
                fps
            });

            return new Promise((resolve, reject) => {
                worker.addEventListener('message', async (event) => {
                    const gifBlob = new Blob([event.data], { type: 'image/gif' });
                    const gifUrl = URL.createObjectURL(gifBlob);

                    const gifImg = document.createElement('img');
                    gifImg.src = gifUrl;

                    output.innerHTML = '';
                    output.appendChild(gifImg);

                    downloadLink.href = gifUrl;
                    downloadLink.style.display = 'inline-block';

                    resolve();
                });

                worker.addEventListener('error', (e) => {
                    console.error('GIF ìƒì„± ì—ëŸ¬:', e);
                    alert('GIF ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                    reject(e);
                });
            });
        }

        async function extractFrames(video, interval) {
            let w = canvas.width;
            canvas.width = 0;
            canvas.width = w;
            const ctx = canvas.getContext('2d');
            const duration = video.duration;
            const frameList = [];

            canvas.width = outputWidth;
            canvas.height = outputHeight;

            preview.innerHTML = '';

            for (let t = 0; t < duration; t += interval) {
                video.currentTime = t;
                await waitForSeek(video);

                ctx.drawImage(video, 0, 0, outputWidth, outputHeight);
                const blob = await new Promise(res => canvas.toBlob(res, 'image/png'));

                const img = document.createElement('img');
                img.src = URL.createObjectURL(blob);
                preview.appendChild(img);

                frameList.push(blob);
            }

            return frameList;
        }

        function waitForSeek(video) {
            return new Promise(resolve => {
                const handler = () => {
                    video.removeEventListener('seeked', handler);
                    resolve();
                };
                video.addEventListener('seeked', handler);
            });
        }

        function blobToImage(blob) {
            return new Promise((resolve) => {
                const img = new Image();
                img.onload = () => resolve(img);
                img.src = URL.createObjectURL(blob);
            });
        }

        // ì „ì²´ í˜ì´ì§€ ë“œë˜ê·¸ ë°©ì§€
        document.addEventListener('dragover', (e) => e.preventDefault());
        document.addEventListener('drop', (e) => e.preventDefault());
    </script>

</body>

</html>