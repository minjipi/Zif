<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéûÔ∏è ZIF - ÌîÑÎ¶¨ÎØ∏ÏóÑ Video to GIF Î≥ÄÌôòÍ∏∞</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Bitcount:wght@400&display=swap"
        rel="stylesheet">
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f3f3f3 0%, #dce6f8 100%);
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .language-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #f6ab7a 0%, #e6956a 100%);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .language-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(246, 171, 122, 0.4);
        }

        .header h1 {
            margin: 0;
            font-size: 2.5rem;
            font-weight: 700;
            font-family: 'Bitcount', 'Inter', sans-serif;
            color: #2d3748;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header h3 {
            margin: 10px 0;
            font-weight: 600;
            font-family: 'Inter', sans-serif;
            color: #4a5568;
        }

        .tagline {
            color: #718096;
            font-size: 0.9rem;
            font-style: italic;
            margin: 10px 0;
        }

        .content {
            padding: 40px 30px;
        }

        .upload-section {
            background: #f3f3f3;
            border: 2px dashed #dce6f8;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .upload-section:hover {
            border-color: #f6ab7a;
            background: #faf9f8;
            transform: translateY(-2px);
        }

        .upload-section.dragover {
            border-color: #f6ab7a;
            background: #faf9f8;
            transform: scale(1.02);
        }

        .upload-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            color: #f6ab7a;
        }

        .upload-text {
            font-size: 1.2rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 10px;
        }

        .upload-subtext {
            color: #718096;
            font-size: 0.9rem;
        }

        #videoInput {
            display: none;
        }

        .settings-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
            margin-bottom: 30px;
        }

        .setting-group {
            background: linear-gradient(135deg, #f3f3f3 0%, #dce6f8 100%);
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #e2e8f0;
            position: relative;
            transition: all 0.3s ease;
        }

        .setting-group:hover {
            border-color: #f6ab7a;
            box-shadow: 0 8px 25px rgba(246, 171, 122, 0.15);
            transform: translateY(-2px);
            position: relative;
            z-index: 1;
        }

        .tooltip {
            position: absolute;
            bottom: -80px;
            left: 0;
            right: 0;
            margin: 0 auto;
            width: 320px;
            transform: translateY(-10px);
            background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 12px;
            font-size: 0.85rem;
            text-align: center;
            line-height: 1.5;
            z-index: 2000;
            pointer-events: none;
            opacity: 0;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .tooltip::after {
            content: '';
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-bottom: 10px solid #2d3748;
        }

        .tooltip.show {
            opacity: 1;
            transform: translateY(0);
        }

        .setting-group label {
            display: block;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 12px;
            font-size: 1rem;
        }

        .setting-group input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
            font-weight: 500;
        }

        .setting-group input:focus {
            outline: none;
            border-color: #f6ab7a;
            box-shadow: 0 0 0 4px rgba(246, 171, 122, 0.1);
            background: white;
        }

        .convert-btn {
            width: 100%;
            background: linear-gradient(135deg, #f6ab7a 0%, #e6956a 100%);
            color: white;
            border: none;
            padding: 20px 30px;
            border-radius: 15px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 30px;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            position: relative;
            overflow: hidden;
        }

        .convert-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .convert-btn:hover:not(:disabled)::before {
            left: 100%;
        }

        .convert-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(246, 171, 122, 0.4);
        }

        .convert-btn:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .preview-section,
        .output-section {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 800;
            color: #2d3748;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            padding-bottom: 10px;
            border-bottom: 3px solid #dce6f8;
        }

        #preview {
            display: flex;
            gap: 15px;
            overflow-x: auto;
            padding: 20px;
            background: linear-gradient(135deg, #f8f9ff 0%, #f0f2ff 100%);
            border-radius: 15px;
            border: 2px solid #e1e5f2;
        }

        #preview::-webkit-scrollbar {
            height: 10px;
        }

        #preview::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 5px;
        }

        #preview::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #f6ab7a, #e6956a);
            border-radius: 5px;
        }

        #preview img {
            max-height: 100px;
            border-radius: 10px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            border: 2px solid white;
        }

        #preview img:hover {
            transform: scale(1.1) rotate(2deg);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        .output-section {
            text-align: center;
        }

        #output img {
            max-width: 100%;
            border-radius: 15px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
            margin-bottom: 25px;
            border: 3px solid white;
        }

        #downloadLink {
            display: inline-block;
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
            text-decoration: none;
            padding: 18px 40px;
            border-radius: 50px;
            font-weight: 700;
            font-size: 1.2rem;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(72, 187, 120, 0.4);
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
        }

        #downloadLink::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s ease;
        }

        #downloadLink:hover::before {
            left: 100%;
        }

        #downloadLink:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(72, 187, 120, 0.5);
        }

        .advanced-settings {
            background: linear-gradient(135deg, #f3f3f3 0%, #dce6f8 100%);
            border-radius: 20px;
            padding: 0;
            margin-top: 30px;
            border: 2px solid #e2e8f0;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .advanced-settings-header {
            background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
            color: white;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            padding: 20px 25px;
            transition: all 0.3s ease;
        }

        .advanced-settings-header:hover {
            background: linear-gradient(135deg, #1a202c 0%, #171923 100%);
        }

        .advanced-settings-title {
            font-size: 1.3rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .toggle-icon {
            font-size: 1.5rem;
            transition: transform 0.4s ease;
            font-weight: bold;
        }

        .toggle-icon.rotated {
            transform: rotate(180deg);
        }

        .advanced-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease;
            padding: 0 25px;
        }

        .advanced-content.expanded {
            max-height: 800px;
            padding: 25px;
        }

        .quality-badge {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            color: #2d3748;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: 700;
            font-size: 0.9rem;
            margin-bottom: 20px;
            display: inline-block;
            box-shadow: 0 4px 12px rgba(255, 215, 0, 0.3);
        }

        canvas,
        video {
            display: none;
        }

        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            color: #2d3748;
            font-weight: 700;
            font-size: 1.1rem;
        }

        .spinner {
            width: 24px;
            height: 24px;
            border: 3px solid #e2e8f0;
            border-top: 3px solid #f6ab7a;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        @media (max-width: 768px) {
            .settings-grid {
                grid-template-columns: 1fr;
            }

            .tooltip {
                width: 280px;
                font-size: 0.8rem;
                bottom: -70px;
            }

            .header h1 {
                font-size: 2.5rem;
            }

            .content {
                padding: 25px 20px;
            }

            .language-toggle {
                position: static;
                margin-bottom: 20px;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1 id="title">ZIF</h1>
            <h3 id="subtitle">Premium Video to GIF Converter</h3>
            <p class="tagline" id="tagline">ÏµúÍ≥† ÌíàÏßàÏùò GIF Î≥ÄÌôòÏùÑ ÏúÑÌïú ÏïàÏ†ÑÌïòÍ≥† ÌòÅÏã†Ï†ÅÏù∏ ÏÜîÎ£®ÏÖò</p>
        </div>

        <div class="content">
            <div class="upload-section" id="uploadSection">
                <div class="upload-icon">üìÅ</div>
                <div class="upload-text" id="uploadText">ÎπÑÎîîÏò§ ÌååÏùºÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</div>
                <div class="upload-subtext" id="uploadSubtext">ÌÅ¥Î¶≠ÌïòÍ±∞ÎÇò ÎìúÎûòÍ∑∏ & ÎìúÎ°≠ÏúºÎ°ú ÏóÖÎ°úÎìúÌïòÎ©¥ ÏûêÎèôÏúºÎ°ú GIFÍ∞Ä ÏÉùÏÑ±Îê©ÎãàÎã§.</div>
                <input type="file" id="videoInput" accept="video/*">
            </div>

            <div class="preview-section" id="previewSection" style="display: none;">
                <div class="section-title">
                    <span>üì∏</span>
                    <span id="previewTitle">ÌîÑÎ†àÏûÑ ÎØ∏Î¶¨Î≥¥Í∏∞</span>
                </div>
                <div id="preview"></div>
            </div>

            <div class="output-section" id="outputSection" style="display: none;">
                <div class="section-title">
                    <span>‚ú®</span>
                    <span id="outputTitle">ÏÉùÏÑ±Îêú GIF</span>
                </div>
                <div id="output"></div>
                <a id="downloadLink" style="display:none;" download="output.gif">
                    <span id="downloadText">GIF Îã§Ïö¥Î°úÎìú</span>
                </a>

                <div class="advanced-settings" id="advancedSettings">
                    <div class="advanced-settings-header" id="advancedToggle">
                        <div class="advanced-settings-title">
                            <span>‚öôÔ∏è</span>
                            <span id="advancedSettingsTitle">Í≥†Í∏â ÏÑ§Ï†ï</span>
                        </div>
                        <div class="toggle-icon" id="toggleIcon">‚ñº</div>
                    </div>
                    <div class="advanced-content expanded" id="advancedContent">
                        <div class="settings-grid">
                            <div class="setting-group">
                                <label for="interval" id="intervalLabel">ÌîÑÎ†àÏûÑ Í∞ÑÍ≤© (Ï¥à)</label>
                                <input type="number" id="interval" value="1" step="0.1">
                            </div>

                            <div class="setting-group">
                                <label for="outputWidth" id="outputWidthLabel">Ï∂úÎ†• Í∞ÄÎ°ú ÌÅ¨Í∏∞ (px)</label>
                                <input type="number" id="outputWidth" value="420" min="1">
                            </div>

                            <div class="setting-group">
                                <label for="quality" id="qualityLabel">ÌíàÏßà (1~100)</label>
                                <input type="number" id="quality" value="1" min="1" max="100">
                            </div>

                            <div class="setting-group">
                                <label for="fps" id="fpsLabel">FPS (ÌîÑÎ†àÏûÑ/Ï¥à)</label>
                                <input type="number" id="fps" value="10" min="1" max="60">
                            </div>
                        </div>

                        <button id="reconvertBtn" class="convert-btn">
                            <span id="reconvertText">üîÑ ÏÉà ÏÑ§Ï†ïÏúºÎ°ú GIF Ïû¨ÏÉùÏÑ±</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <video id="video" crossorigin="anonymous"></video>
    <canvas id="canvas"></canvas>
    <script src="/coi-serviceworker.js"></script>

    <script type="module">


        // Îã§Íµ≠Ïñ¥ ÏßÄÏõê
        let currentLanguage = localStorage.getItem('zifLanguage') || 'ko';

        const translations = {
            ko: {
                title: 'ZIF',
                subtitle: 'Premium Video to GIF Converter',
                tagline: 'ÏµúÍ≥† ÌíàÏßàÏùò GIF Î≥ÄÌôòÏùÑ ÏúÑÌïú ÏïàÏ†ÑÌïòÍ≥† ÌòÅÏã†Ï†ÅÏù∏ ÏÜîÎ£®ÏÖò',
                uploadText: 'ÎπÑÎîîÏò§ ÌååÏùºÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî',
                uploadSubtext: 'ÌÅ¥Î¶≠ÌïòÍ±∞ÎÇò ÎìúÎûòÍ∑∏ & ÎìúÎ°≠ÏúºÎ°ú ÏóÖÎ°úÎìúÌïòÎ©¥ ÏûêÎèôÏúºÎ°ú GIFÍ∞Ä ÏÉùÏÑ±Îê©ÎãàÎã§.',
                previewTitle: 'ÌîÑÎ†àÏûÑ ÎØ∏Î¶¨Î≥¥Í∏∞',
                outputTitle: 'ÏÉùÏÑ±Îêú GIF',
                downloadText: 'GIF Îã§Ïö¥Î°úÎìú',
                advancedSettingsTitle: 'Í≥†Í∏â ÏÑ§Ï†ï',
                intervalLabel: 'ÌîÑÎ†àÏûÑ Í∞ÑÍ≤© (Ï¥à)',
                outputWidthLabel: 'Ï∂úÎ†• Í∞ÄÎ°ú ÌÅ¨Í∏∞ (px)',
                qualityLabel: 'ÌíàÏßà (1~100)',
                fpsLabel: 'FPS (ÌîÑÎ†àÏûÑ/Ï¥à)',
                reconvertText: 'üîÑ ÏÉà ÏÑ§Ï†ïÏúºÎ°ú GIF Ïû¨ÏÉùÏÑ±',
                loadingVideo: 'ÎπÑÎîîÏò§Î•º Î°úÎî© Ï§ë...',
                extractingFrames: 'ÌîÑÎ†àÏûÑÏùÑ Ï∂îÏ∂ú Ï§ë...',
                generatingGif: 'GIF ÏÉùÏÑ± Ï§ë...',
                completed: 'GIF ÏÉùÏÑ± ÏôÑÎ£å!',
                completedSubtext: 'ÏïÑÎûò Í≥†Í∏â ÏÑ§Ï†ïÏóêÏÑú Îã§Î•∏ ÏòµÏÖòÏúºÎ°ú Ïû¨ÏÉùÏÑ±Ìï† Ïàò ÏûàÏäµÎãàÎã§',
                regeneratingGif: 'GIF Ïû¨ÏÉùÏÑ± Ï§ë...',
                langToggleText: 'ÌïúÍµ≠Ïñ¥'
            },
            en: {
                title: 'ZIF',
                subtitle: 'Premium Video to GIF Converter',
                tagline: 'Safe and innovative solution for highest quality GIF conversion',
                uploadText: 'Select Video File',
                uploadSubtext: 'Click or drag & drop to upload and automatically generate GIF.',
                previewTitle: 'Frame Preview',
                outputTitle: 'Generated GIF',
                downloadText: 'üì• Download GIF',
                advancedSettingsTitle: 'Advanced Settings',
                intervalLabel: 'Frame Interval (seconds)',
                outputWidthLabel: 'Output Width (px)',
                qualityLabel: 'Quality (1~100)',
                fpsLabel: 'FPS (frames/second)',
                reconvertText: 'üîÑ Regenerate GIF with New Settings',
                loadingVideo: 'Loading video...',
                extractingFrames: 'Extracting frames...',
                generatingGif: 'Generating GIF...',
                completed: 'GIF Generation Complete!',
                completedSubtext: 'You can regenerate with different options in advanced settings below',
                regeneratingGif: 'Regenerating GIF...',
                langToggleText: 'English'
            },
            ja: {
                title: 'ZIF',
                subtitle: '„Éó„É¨„Éü„Ç¢„É† Video to GIF „Ç≥„É≥„Éê„Éº„Çø„Éº',
                tagline: 'ÊúÄÈ´òÂìÅË≥™„ÅÆGIFÂ§âÊèõ„ÅÆ„Åü„ÇÅ„ÅÆÂÆâÂÖ®„ÅßÈù©Êñ∞ÁöÑ„Å™„ÇΩ„É™„É•„Éº„Ç∑„Éß„É≥',
                uploadText: '„Éì„Éá„Ç™„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ',
                uploadSubtext: '„ÇØ„É™„ÉÉ„ÇØ„Åæ„Åü„ÅØ„Éâ„É©„ÉÉ„Ç∞&„Éâ„É≠„ÉÉ„Éó„Åß„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„Åô„Çã„Å®Ëá™ÂãïÁöÑ„Å´GIF„ÅåÁîüÊàê„Åï„Çå„Åæ„Åô„ÄÇ',
                previewTitle: '„Éï„É¨„Éº„É†„Éó„É¨„Éì„É•„Éº',
                outputTitle: 'ÁîüÊàê„Åï„Çå„ÅüGIF',
                downloadText: 'üì• GIF„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ',
                advancedSettingsTitle: 'Ë©≥Á¥∞Ë®≠ÂÆö',
                intervalLabel: '„Éï„É¨„Éº„É†ÈñìÈöîÔºàÁßíÔºâ',
                outputWidthLabel: 'Âá∫ÂäõÂπÖÔºàpxÔºâ',
                qualityLabel: 'ÂìÅË≥™Ôºà1~100Ôºâ',
                fpsLabel: 'FPSÔºà„Éï„É¨„Éº„É†/ÁßíÔºâ',
                reconvertText: 'üîÑ Êñ∞„Åó„ÅÑË®≠ÂÆö„ÅßGIFÂÜçÁîüÊàê',
                loadingVideo: '„Éì„Éá„Ç™„ÇíË™≠„ÅøËæº„Åø‰∏≠...',
                extractingFrames: '„Éï„É¨„Éº„É†„ÇíÊäΩÂá∫‰∏≠...',
                generatingGif: 'GIFÁîüÊàê‰∏≠...',
                completed: 'GIFÁîüÊàêÂÆå‰∫ÜÔºÅ',
                completedSubtext: '‰∏ã„ÅÆË©≥Á¥∞Ë®≠ÂÆö„Åß‰ªñ„ÅÆ„Ç™„Éó„Ç∑„Éß„É≥„ÅßÂÜçÁîüÊàê„Åß„Åç„Åæ„Åô',
                regeneratingGif: 'GIFÂÜçÁîüÊàê‰∏≠...',
                langToggleText: 'Êó•Êú¨Ë™û'
            },
            zh: {
                title: 'ZIF',
                subtitle: 'È´òÁ∫ßËßÜÈ¢ëËΩ¨GIFËΩ¨Êç¢Âô®',
                tagline: 'Áî®‰∫éÊúÄÈ´òË¥®ÈáèGIFËΩ¨Êç¢ÁöÑÂÆâÂÖ®ÂàõÊñ∞Ëß£ÂÜ≥ÊñπÊ°à',
                uploadText: 'ÈÄâÊã©ËßÜÈ¢ëÊñá‰ª∂',
                uploadSubtext: 'ÁÇπÂáªÊàñÊãñÊîæ‰∏ä‰º†ÔºåËá™Âä®ÁîüÊàêGIF„ÄÇ',
                previewTitle: 'Â∏ßÈ¢ÑËßà',
                outputTitle: 'ÁîüÊàêÁöÑGIF',
                downloadText: 'üì• ‰∏ãËΩΩGIF',
                advancedSettingsTitle: 'È´òÁ∫ßËÆæÁΩÆ',
                intervalLabel: 'Â∏ßÈó¥ÈöîÔºàÁßíÔºâ',
                outputWidthLabel: 'ËæìÂá∫ÂÆΩÂ∫¶ÔºàpxÔºâ',
                qualityLabel: 'Ë¥®ÈáèÔºà1~100Ôºâ',
                fpsLabel: 'FPSÔºàÂ∏ß/ÁßíÔºâ',
                reconvertText: 'üîÑ ‰ΩøÁî®Êñ∞ËÆæÁΩÆÈáçÊñ∞ÁîüÊàêGIF',
                loadingVideo: 'Ê≠£Âú®Âä†ËΩΩËßÜÈ¢ë...',
                extractingFrames: 'Ê≠£Âú®ÊèêÂèñÂ∏ß...',
                generatingGif: 'Ê≠£Âú®ÁîüÊàêGIF...',
                completed: 'GIFÁîüÊàêÂÆåÊàêÔºÅ',
                completedSubtext: 'ÊÇ®ÂèØ‰ª•Âú®‰∏ãÈù¢ÁöÑÈ´òÁ∫ßËÆæÁΩÆ‰∏≠‰ΩøÁî®‰∏çÂêåÈÄâÈ°πÈáçÊñ∞ÁîüÊàê',
                regeneratingGif: 'Ê≠£Âú®ÈáçÊñ∞ÁîüÊàêGIF...',
                langToggleText: '‰∏≠Êñá'
            }
        };


        // Ìà¥ÌåÅ Í∏∞Îä•
        const tooltips = {
            ko: {
                'interval': 'ÎπÑÎîîÏò§ÏóêÏÑú ÌîÑÎ†àÏûÑÏùÑ Ï∂îÏ∂úÌïòÎäî ÏãúÍ∞Ñ Í∞ÑÍ≤©ÏûÖÎãàÎã§. Í∞íÏù¥ ÏûëÏùÑÏàòÎ°ù Îçî Î∂ÄÎìúÎü¨Ïö¥ GIFÍ∞Ä ÏÉùÏÑ±ÎêòÏßÄÎßå ÌååÏùº ÌÅ¨Í∏∞Í∞Ä Ïª§ÏßëÎãàÎã§.',
                'outputWidth': 'GIFÏùò Í∞ÄÎ°ú ÌîΩÏÖÄ ÌÅ¨Í∏∞ÏûÖÎãàÎã§. Í∞íÏù¥ ÌÅ¥ÏàòÎ°ù ÌôîÏßàÏù¥ Ï¢ãÏïÑÏßÄÏßÄÎßå ÌååÏùº ÌÅ¨Í∏∞Í∞Ä Ïª§ÏßëÎãàÎã§.',
                'quality': 'GIFÏùò ÏïïÏ∂ï ÌíàÏßàÏûÖÎãàÎã§. 1Ïù¥ ÏµúÍ≥† ÌíàÏßà(ÏµúÎåÄ ÌååÏùº ÌÅ¨Í∏∞), 100Ïù¥ ÏµúÏ†Ä ÌíàÏßà(ÏµúÏÜå ÌååÏùº ÌÅ¨Í∏∞)ÏûÖÎãàÎã§.',
                'fps': 'Ï¥àÎãπ ÌëúÏãúÎêòÎäî ÌîÑÎ†àÏûÑ ÏàòÏûÖÎãàÎã§. Í∞íÏù¥ ÌÅ¥ÏàòÎ°ù Îπ†Î•¥Í≤å Ïû¨ÏÉùÎêòÍ≥†, ÏûëÏùÑÏàòÎ°ù ÎäêÎ¶¨Í≤å Ïû¨ÏÉùÎê©ÎãàÎã§.'
            },
            en: {
                'interval': 'Time interval for extracting frames from video. Smaller values create smoother GIFs but larger file sizes.',
                'outputWidth': 'Horizontal pixel size of the GIF. Larger values improve quality but increase file size.',
                'quality': 'GIF compression quality. 1 is highest quality (largest file size), 100 is lowest quality (smallest file size).',
                'fps': 'Frames displayed per second. Higher values play faster, lower values play slower.'
            },
            ja: {
                'interval': '„Éì„Éá„Ç™„Åã„Çâ„Éï„É¨„Éº„É†„ÇíÊäΩÂá∫„Åô„ÇãÊôÇÈñìÈñìÈöî„Åß„Åô„ÄÇÂÄ§„ÅåÂ∞è„Åï„ÅÑ„Åª„Å©„Çπ„É†„Éº„Ç∫„Å™GIF„ÅåÁîüÊàê„Åï„Çå„Åæ„Åô„Åå„ÄÅ„Éï„Ç°„Ç§„É´„Çµ„Ç§„Ç∫„ÅåÂ§ß„Åç„Åè„Å™„Çä„Åæ„Åô„ÄÇ',
                'outputWidth': 'GIF„ÅÆÊ®™„Éî„ÇØ„Çª„É´„Çµ„Ç§„Ç∫„Åß„Åô„ÄÇÂÄ§„ÅåÂ§ß„Åç„ÅÑ„Åª„Å©ÁîªË≥™„ÅåËâØ„Åè„Å™„Çä„Åæ„Åô„Åå„ÄÅ„Éï„Ç°„Ç§„É´„Çµ„Ç§„Ç∫„ÅåÂ§ß„Åç„Åè„Å™„Çä„Åæ„Åô„ÄÇ',
                'quality': 'GIF„ÅÆÂúßÁ∏ÆÂìÅË≥™„Åß„Åô„ÄÇ1„ÅåÊúÄÈ´òÂìÅË≥™ÔºàÊúÄÂ§ß„Éï„Ç°„Ç§„É´„Çµ„Ç§„Ç∫Ôºâ„ÄÅ100„ÅåÊúÄ‰ΩéÂìÅË≥™ÔºàÊúÄÂ∞è„Éï„Ç°„Ç§„É´„Çµ„Ç§„Ç∫Ôºâ„Åß„Åô„ÄÇ',
                'fps': '1ÁßíÈñì„Å´Ë°®Á§∫„Åï„Çå„Çã„Éï„É¨„Éº„É†Êï∞„Åß„Åô„ÄÇÂÄ§„ÅåÂ§ß„Åç„ÅÑ„Åª„Å©È´òÈÄüÂÜçÁîü„Åï„Çå„ÄÅÂ∞è„Åï„ÅÑ„Åª„Å©‰ΩéÈÄüÂÜçÁîü„Åï„Çå„Åæ„Åô„ÄÇ'
            },
            zh: {
                'interval': '‰ªéËßÜÈ¢ë‰∏≠ÊèêÂèñÂ∏ßÁöÑÊó∂Èó¥Èó¥Èöî„ÄÇÂÄºË∂äÂ∞èÁîüÊàêÁöÑGIFË∂äÊµÅÁïÖÔºå‰ΩÜÊñá‰ª∂Â§ßÂ∞èË∂äÂ§ß„ÄÇ',
                'outputWidth': 'GIFÁöÑÊ∞¥Âπ≥ÂÉèÁ¥†Â§ßÂ∞è„ÄÇÂÄºË∂äÂ§ßÁîªË¥®Ë∂äÂ•ΩÔºå‰ΩÜÊñá‰ª∂Â§ßÂ∞èË∂äÂ§ß„ÄÇ',
                'quality': 'GIFÂéãÁº©Ë¥®Èáè„ÄÇ1‰∏∫ÊúÄÈ´òË¥®ÈáèÔºàÊúÄÂ§ßÊñá‰ª∂Â§ßÂ∞èÔºâÔºå100‰∏∫ÊúÄ‰ΩéË¥®ÈáèÔºàÊúÄÂ∞èÊñá‰ª∂Â§ßÂ∞èÔºâ„ÄÇ',
                'fps': 'ÊØèÁßíÊòæÁ§∫ÁöÑÂ∏ßÊï∞„ÄÇÂÄºË∂äÂ§ßÊí≠ÊîæË∂äÂø´ÔºåË∂äÂ∞èÊí≠ÊîæË∂äÊÖ¢„ÄÇ'
            }
        }

        function setupTooltips() {
            const settingGroups = document.querySelectorAll('.setting-group');

            settingGroups.forEach((group, index) => {
                const input = group.querySelector('input');
                const inputId = input.id;

                if (tooltips[currentLanguage] && tooltips[currentLanguage][inputId]) {
                    // Í∏∞Ï°¥ Ìà¥ÌåÅ Ï†úÍ±∞
                    const existingTooltip = group.querySelector('.tooltip');
                    if (existingTooltip) {
                        existingTooltip.remove();
                    }

                    const tooltip = document.createElement('div');
                    tooltip.className = 'tooltip';
                    tooltip.textContent = tooltips[currentLanguage][inputId];
                    group.appendChild(tooltip);

                    group.addEventListener('mouseenter', () => {
                        tooltip.classList.add('show');
                    });

                    group.addEventListener('mouseleave', () => {
                        tooltip.classList.remove('show');
                    });
                }
            });
        }

        function updateAllTexts() {
            const t = translations[currentLanguage];

            document.getElementById('title').textContent = t.title;
            document.getElementById('subtitle').textContent = t.subtitle;
            document.getElementById('tagline').textContent = t.tagline;
            document.getElementById('uploadText').textContent = t.uploadText;
            document.getElementById('uploadSubtext').textContent = t.uploadSubtext;
            document.getElementById('previewTitle').textContent = t.previewTitle;
            document.getElementById('outputTitle').textContent = t.outputTitle;
            document.getElementById('downloadText').textContent = t.downloadText;
            document.getElementById('advancedSettingsTitle').textContent = t.advancedSettingsTitle;
            document.getElementById('intervalLabel').textContent = t.intervalLabel;
            document.getElementById('outputWidthLabel').textContent = t.outputWidthLabel;
            document.getElementById('qualityLabel').textContent = t.qualityLabel;
            document.getElementById('fpsLabel').textContent = t.fpsLabel;
            document.getElementById('reconvertText').textContent = t.reconvertText;

            // Ìà¥ÌåÅ ÏóÖÎç∞Ïù¥Ìä∏
            setupTooltips();
        }

        if (!localStorage.getItem('zifLanguage')) {
            const browserLang = navigator.language.slice(0, 2); // 'en-US' ‚Üí 'en'
            const supportedLangs = ['ko', 'en', 'ja', 'zh'];
            currentLanguage = supportedLangs.includes(browserLang) ? browserLang : 'en';
            localStorage.setItem('zifLanguage', currentLanguage);
        }
        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ïñ∏Ïñ¥ ÏÑ§Ï†ï Ï†ÅÏö©
        updateAllTexts();



        // Ï†ÑÏó≠ Î≥ÄÏàòÎì§
        let defaultInterval = 1;
        let defaultwWidth = 420;
        let defaultQuality = 70;
        let defaultFps = 1;

        let frames = [];
        let outputWidth = 420;
        let outputHeight = 0;
        let currentVideoFile = null;

        // DOM ÏöîÏÜåÎì§
        const videoInput = document.getElementById('videoInput');
        const reconvertBtn = document.getElementById('reconvertBtn');
        const video = document.getElementById('video');
        const canvas = document.getElementById('canvas');
        const preview = document.getElementById('preview');
        const output = document.getElementById('output');
        const downloadLink = document.getElementById('downloadLink');
        const intervalInput = document.getElementById('interval');
        const qualityInput = document.getElementById('quality');
        const fpsInput = document.getElementById('fps');
        const outputWidthInput = document.getElementById('outputWidth');
        const uploadSection = document.getElementById('uploadSection');
        const outputSection = document.getElementById('outputSection');
        const previewSection = document.getElementById('previewSection');
        const advancedToggle = document.getElementById('advancedToggle');
        const advancedContent = document.getElementById('advancedContent');
        const toggleIcon = document.getElementById('toggleIcon');

        // Í≥†Í∏â ÏÑ§Ï†ï ÌÜ†Í∏Ä
        advancedToggle.addEventListener('click', () => {
            advancedContent.classList.toggle('expanded');
            toggleIcon.classList.toggle('rotated');
        });

        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ìà¥ÌåÅ ÏÑ§Ï†ï
        setupTooltips();


        // ÎìúÎûòÍ∑∏ Ïï§ ÎìúÎ°≠ Í∏∞Îä•
        uploadSection.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadSection.classList.add('dragover');
        });

        uploadSection.addEventListener('dragleave', (e) => {
            e.preventDefault();
            uploadSection.classList.remove('dragover');
        });

        uploadSection.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadSection.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0 && files[0].type.startsWith('video/')) {
                handleVideoFile(files[0]);
            }
        });

        uploadSection.addEventListener('click', () => {
            videoInput.click();
        });

        // Í∏∞Ï°¥ Í∏∞Îä• Ïú†ÏßÄ
        videoInput.addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if (!file) return;
            handleVideoFile(file);
        });

        async function handleVideoFile(file) {
            currentVideoFile = file;

            // Î°úÎî© ÌëúÏãú
            uploadSection.innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                    <span>ÎπÑÎîîÏò§Î•º Î°úÎî© Ï§ë...</span>
                </div>
            `;

            video.src = URL.createObjectURL(file);
            await video.play();
            video.pause();

            // Í∏∞Î≥∏ ÏÑ§Ï†ïÍ∞í Ï†ÅÏö©
            outputWidth = defaultwWidth;
            const aspectRatio = video.videoHeight / video.videoWidth;
            outputHeight = Math.round(outputWidth * aspectRatio);

            // ÌîÑÎ†àÏûÑ Ï∂îÏ∂ú ÌëúÏãú
            uploadSection.innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                    <span>ÌîÑÎ†àÏûÑÏùÑ Ï∂îÏ∂ú Ï§ë...</span>
                </div>
            `;

            // Í∏∞Î≥∏Í∞íÏúºÎ°ú ÌîÑÎ†àÏûÑ Ï∂îÏ∂ú
            frames = await extractFrames(video, defaultInterval);

            // ÎØ∏Î¶¨Î≥¥Í∏∞ ÏÑπÏÖò ÌëúÏãú
            previewSection.style.display = 'block';

            // GIF ÏûêÎèô ÏÉùÏÑ± ÏãúÏûë
            uploadSection.innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                    <span>GIF ÏÉùÏÑ± Ï§ë...</span>
                </div>
            `;

            // ÏûêÎèôÏúºÎ°ú GIF ÏÉùÏÑ±
            await generateGIF(frames, defaultwWidth, defaultQuality, defaultFps);

            // ÏôÑÎ£å ÌëúÏãú
            uploadSection.innerHTML = `
                <div class="upload-icon">‚úÖ</div>
                <div class="upload-text">GIF ÏÉùÏÑ± ÏôÑÎ£å!</div>
                <div class="upload-subtext">ÏïÑÎûò Í≥†Í∏â ÏÑ§Ï†ïÏóêÏÑú Îã§Î•∏ ÏòµÏÖòÏúºÎ°ú Ïû¨ÏÉùÏÑ±Ìï† Ïàò ÏûàÏäµÎãàÎã§</div>
            `;

            // Ï∂úÎ†• ÏÑπÏÖò ÌëúÏãú
            outputSection.style.display = 'block';
        }

        // Ïû¨Î≥ÄÌôò Î≤ÑÌäº Ïù¥Î≤§Ìä∏
        reconvertBtn.addEventListener('click', async () => {
            if (!currentVideoFile) return;

            const originalText = reconvertBtn.textContent;
            reconvertBtn.innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                    <span>GIF Ïû¨ÏÉùÏÑ± Ï§ë...</span>
                </div>
            `;
            reconvertBtn.disabled = true;

            // ÏÉàÎ°úÏö¥ ÏÑ§Ï†ïÍ∞í Ï†ÅÏö©
            const newInterval = parseFloat(intervalInput.value) || 1;
            const newWidth = parseInt(outputWidthInput.value, 10) || 420;
            const newQuality = parseInt(qualityInput.value, 10) || 1;
            const newFps = parseInt(fpsInput.value, 10) || 10;

            // ÌÅ¨Í∏∞Í∞Ä Î≥ÄÍ≤ΩÎêòÏóàÏúºÎ©¥ ÌîÑÎ†àÏûÑ Ïû¨Ï∂îÏ∂ú
            if (newWidth !== defaultwWidth || newInterval !== defaultInterval) {
                defaultwWidth = newWidth;
                defaultInterval = newInterval;
                outputWidth = newWidth;
                const aspectRatio = video.videoHeight / video.videoWidth;
                outputHeight = Math.round(outputWidth * aspectRatio);

                frames = await extractFrames(video, newInterval);
            }

            await generateGIF(frames, newWidth, newQuality, newFps);

            reconvertBtn.textContent = originalText;
            reconvertBtn.disabled = false;
        });

        async function generateGIF(frameList, width, quality, fps) {
            const ctx = canvas.getContext('2d');
            const imageDatas = [];

            canvas.width = width;
            canvas.height = outputHeight;

            for (const blob of frameList) {
                const img = await blobToImage(blob);
                ctx.drawImage(img, 0, 0, width, canvas.height);
                const data = ctx.getImageData(0, 0, width, canvas.height);
                imageDatas.push(data);
            }

            const worker = new Worker(new URL('./assets/gif.worker.js', import.meta.url), { type: 'module' });

            worker.postMessage({
                frames: imageDatas,
                width: width,
                height: canvas.height,
                quality,
                fps
            });

            return new Promise((resolve, reject) => {
                worker.addEventListener('message', async (event) => {
                    const gifBlob = new Blob([event.data], { type: 'image/gif' });
                    const gifUrl = URL.createObjectURL(gifBlob);

                    const gifImg = document.createElement('img');
                    gifImg.src = gifUrl;

                    output.innerHTML = '';
                    output.appendChild(gifImg);

                    downloadLink.href = gifUrl;
                    downloadLink.style.display = 'inline-block';

                    resolve();
                });

                worker.addEventListener('error', (e) => {
                    console.error('GIF ÏÉùÏÑ± ÏóêÎü¨:', e);
                    alert('GIF ÏÉùÏÑ± Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
                    reject(e);
                });
            });
        }

        async function extractFrames(video, interval) {
            let w = canvas.width;
            canvas.width = 0;
            canvas.width = w;
            const ctx = canvas.getContext('2d');
            const duration = video.duration;
            const frameList = [];

            canvas.width = outputWidth;
            canvas.height = outputHeight;

            preview.innerHTML = '';

            for (let t = 0; t < duration; t += interval) {
                video.currentTime = t;
                await waitForSeek(video);

                ctx.drawImage(video, 0, 0, outputWidth, outputHeight);
                const blob = await new Promise(res => canvas.toBlob(res, 'image/png'));

                const img = document.createElement('img');
                img.src = URL.createObjectURL(blob);
                preview.appendChild(img);

                frameList.push(blob);
            }

            return frameList;
        }

        function waitForSeek(video) {
            return new Promise(resolve => {
                const handler = () => {
                    video.removeEventListener('seeked', handler);
                    resolve();
                };
                video.addEventListener('seeked', handler);
            });
        }

        function blobToImage(blob) {
            return new Promise((resolve) => {
                const img = new Image();
                img.onload = () => resolve(img);
                img.src = URL.createObjectURL(blob);
            });
        }

        // Ï†ÑÏ≤¥ ÌéòÏù¥ÏßÄ ÎìúÎûòÍ∑∏ Î∞©ÏßÄ
        document.addEventListener('dragover', (e) => e.preventDefault());
        document.addEventListener('drop', (e) => e.preventDefault());
    </script>

</body>

</html>